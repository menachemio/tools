# Microservices project session configuration
name: microservices
timezone: America/New_York
show_utc: true
color: colour202

# Override default tmux options programmatically
tmux:
  # Global options (set-option -g): apply server-wide via tmux.conf
  global:
    mouse: on
    status-position: top
    status-interval: 2
    pane-border-style: "fg=colour240"
    pane-active-border-style: "fg=colour202,bold"

  # Session options (set-option -t <session>): apply to this session at runtime
  session:
    status-style: "fg=white,bg=colour202"
    status-left: "#[fg=black,bg=colour202,bold] MICRO #S #[default] "
    status-right: "#[fg=colour202] %H:%M %Z #[default]"
    status-justify: centre

subsessions:
  auth-service:
    dir: ./services/auth
    command: go run main.go

  api-gateway:
    dir: ./services/gateway
    command: npm run dev
    delay: 5
    # Per-subsession tmux options (override color-derived styling)
    tmux:
      status-style: "fg=colour51,bg=default"
      status-left: "#[fg=colour51,bold] GW #S #[default]"

  user-service:
    dir: ./services/users
    command: npm run dev
    delay: 3

  database:
    dir: ./
    command: docker-compose up -d postgres redis

windows:
  - name: services
    color: colour51
    # Per-window tmux options (set-window-option -t <session>:<window>)
    tmux:
      window-status-current-style: "fg=black,bg=colour51,bold"
      window-status-style: "fg=colour51,bg=default,dim"
    panes:
      - type: subsession
        subsession: auth-service
      - type: subsession
        subsession: api-gateway
      - type: subsession
        subsession: user-service
      - type: subsession
        subsession: database

  - name: monitoring
    color: colour196
    panes:
      - type: command
        cmd: "watch docker ps"
        execute: true
      - type: command
        cmd: "docker-compose logs -f"
        execute: false
        history: true

  - name: development
    color: colour46
    panes:
      - type: command
        cmd: nvim
        execute: true
      - type: command
        cmd: "git status && git log --oneline -10"
        execute: true
        history: true
